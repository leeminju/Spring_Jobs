<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>게시물</title>
    <link rel="shortcut icon" href="#">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
            integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/basic.js"></script>
</head>

<script>
    $(document).ready(function () {
        const receivedData = location.href.split('?')[1];
        let id = Number(receivedData); // data
        getPost(id);
    })

    function getPost(id) {
        $.ajax({
            type: 'GET',
            url: `/api/posts/${id}`,
            contentType: 'application/json',
            success: function (response) {
                let title = response['title'];
                let image = response['image'];
                let contents = response['contents'];
                let deadline = response['deadline'];
                let career = response['career'];
                let skill = response['skill'];
                let empType = response['empType'];
                let education = response['education'];
                let company = response['company'];

                let companyName = company['companyName'];
                let email = company['email'];
                let phone = company['phone'];
                let location = company['location'];
                let industry = company['industry'];


                $('title').text(title);
                $('#title').text(title);
                $('#image').attr("src", image);
                $('#contents').text(contents);
                $('#career').text(career);
                $('#skill').text(skill);
                $('#deadline').text(deadline);
                $('#empType').text(empType);
                $('#education').text(education);

                $('#companyName').text(companyName);
                $('#email').text(email);
                $('#phone').text(phone);
                $('#industry').text(industry);
                $('#location').text(location);

                if($('#owner').val() === company['loginId']) {
                    let html = `<div>
                                    <button class="btn btn-primary" onclick="location.href='/posts/${response["id"]}/edit'">수정</button>
                                </div>
                                `
                    $('#title').append(html);
                }

            },
            error(error, status, request) {
                console.log(error);
            }
        });
    }
</script>
<body>
<header class="p-3 text-bg-white">
    <div th:replace="~{/fragments/header.html}"></div>
</header>

<div id="post-box">
    <div id ="post-box2">
        <h1 id="title"></h1>
        <img class="post_image" id="image" src="" alt="...">
        <div id="company-box">
            <h3>기업 정보</h3>
            <br>
            기업명 :
            <span id="companyName"></span>
            <br>
            이메일 :
            <span id="email"></span>
            <br>
            전화번호 :
            <span id="phone"></span>
            <br>
            산업군:
            <span id="industry"></span>
            <br>
            위치:
            <span id="location"></span>
        </div>

        <div id="contents"></div>

        <div id="post-info">
            <br>
            고용 형태 :
            <span id="empType"></span>
            스킬 :
            <span id="skill"></span>
            <br>
            직무 :
            <span id="career"></span>
            <br>
            학력 :
            <span id="education"></span>
            <br>
            마감일:
            <span id="deadline"></span>
        </div>
    </div>
</div>

</body>
</html>